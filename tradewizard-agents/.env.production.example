# ============================================================================
# TradeWizard Monitor - Production Configuration
# ============================================================================
# This file contains production-ready configuration for the Automated Market
# Monitor. Copy this file to .env.production and fill in your actual values.
#
# SECURITY: Never commit this file with real credentials to version control!

# ============================================================================
# Environment
# ============================================================================
NODE_ENV=production
LOG_LEVEL=info

# ============================================================================
# Supabase (Production) - REQUIRED
# ============================================================================
# Get these from your production Supabase project:
# https://app.supabase.com/project/YOUR_PROJECT/settings/api

SUPABASE_URL=https://your-prod-project.supabase.co
SUPABASE_KEY=your_production_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_production_service_role_key_here

# ============================================================================
# LLM Configuration - REQUIRED
# ============================================================================
# Option 1: Single Provider (Cost-Effective)
# Uncomment and configure ONE provider

# OpenAI (Recommended for production)
LLM_SINGLE_PROVIDER=openai
OPENAI_API_KEY=sk-prod-your_openai_key_here
OPENAI_DEFAULT_MODEL=gpt-4o-mini

# Anthropic
# LLM_SINGLE_PROVIDER=anthropic
# ANTHROPIC_API_KEY=sk-ant-prod-your_anthropic_key_here
# ANTHROPIC_DEFAULT_MODEL=claude-3-haiku-20240307

# Google AI
# LLM_SINGLE_PROVIDER=google
# GOOGLE_API_KEY=your_google_api_key_here
# GOOGLE_DEFAULT_MODEL=gemini-1.5-flash

# Option 2: Multi-Provider (Higher Quality)
# Uncomment and configure multiple providers
# Leave LLM_SINGLE_PROVIDER commented out

# OPENAI_API_KEY=sk-prod-your_openai_key_here
# OPENAI_DEFAULT_MODEL=gpt-4-turbo
# ANTHROPIC_API_KEY=sk-ant-prod-your_anthropic_key_here
# ANTHROPIC_DEFAULT_MODEL=claude-3-sonnet-20240229
# GOOGLE_API_KEY=your_google_api_key_here
# GOOGLE_DEFAULT_MODEL=gemini-1.5-pro

# ============================================================================
# Polymarket API - REQUIRED
# ============================================================================
POLYMARKET_GAMMA_API_URL=https://gamma-api.polymarket.com
POLYMARKET_CLOB_API_URL=https://clob.polymarket.com
POLYMARKET_RATE_LIMIT_BUFFER=80

# Enhanced Event-Based Configuration for Production
POLYMARKET_POLITICS_TAG_ID=2
POLYMARKET_EVENTS_API_ENDPOINT=/events
POLYMARKET_INCLUDE_RELATED_TAGS=true
POLYMARKET_MAX_EVENTS_PER_DISCOVERY=20
POLYMARKET_MAX_MARKETS_PER_EVENT=50
POLYMARKET_DEFAULT_SORT_BY=volume24hr
POLYMARKET_ENABLE_CROSS_MARKET_ANALYSIS=true
POLYMARKET_CORRELATION_THRESHOLD=0.3
POLYMARKET_ARBITRAGE_THRESHOLD=0.05

# Production Environment-Specific Configuration
POLYMARKET_PROD_EVENTS_API_RATE_LIMIT=500
POLYMARKET_PROD_MAX_REQUESTS_PER_MINUTE=60
POLYMARKET_PROD_EVENT_CACHE_TTL=300
POLYMARKET_PROD_ENABLE_DEBUG_LOGGING=false
POLYMARKET_PROD_ENABLE_MOCK_DATA=false

# Feature Flags (Production Settings)
POLYMARKET_ENABLE_EVENT_BASED_KEYWORDS=true
POLYMARKET_ENABLE_MULTI_MARKET_ANALYSIS=true
POLYMARKET_ENABLE_CROSS_MARKET_CORRELATION=true
POLYMARKET_ENABLE_ARBITRAGE_DETECTION=true
POLYMARKET_ENABLE_EVENT_LEVEL_INTELLIGENCE=true
POLYMARKET_ENABLE_ENHANCED_EVENT_DISCOVERY=true
POLYMARKET_ENABLE_MULTI_MARKET_FILTERING=true
POLYMARKET_ENABLE_EVENT_RANKING_ALGORITHM=true
POLYMARKET_ENABLE_CROSS_MARKET_OPPORTUNITIES=true

# Error Handling and Resilience
POLYMARKET_MAX_RETRIES=3
POLYMARKET_CIRCUIT_BREAKER_THRESHOLD=5
POLYMARKET_FALLBACK_TO_CACHE=true
POLYMARKET_ENABLE_GRACEFUL_DEGRADATION=true

# Analysis Configuration
POLYMARKET_KEYWORD_EXTRACTION_MODE=event_priority
POLYMARKET_CORRELATION_ANALYSIS_DEPTH=basic
POLYMARKET_RISK_ASSESSMENT_LEVEL=moderate

# ============================================================================
# Scheduling Configuration
# ============================================================================
# How often to discover and analyze new markets (in hours)
ANALYSIS_INTERVAL_HOURS=24

# How often to update existing market recommendations (in hours)
UPDATE_INTERVAL_HOURS=24

# Maximum number of markets to analyze per cycle
# Keep low (1-3) to control costs
MAX_MARKETS_PER_CYCLE=3

# ============================================================================
# API Quota Management
# ============================================================================
# Daily API quotas to stay within free-tier limits
# Adjust based on your API plan tier

# NewsAPI (legacy - free tier: 100/day)
NEWS_API_DAILY_QUOTA=100

# NewsData.io (basic plan: 20,000/day)
NEWSDATA_DAILY_QUOTA=20000

# Twitter API (free tier: 500/day)
TWITTER_API_DAILY_QUOTA=500

# Reddit API (free tier: 60/hour)
REDDIT_API_DAILY_QUOTA=60

# ============================================================================
# News API Configuration (Production)
# ============================================================================
# Configure news data sources for production use

# Legacy NewsAPI (will be deprecated)
NEWS_API_PROVIDER=newsapi
NEWS_API_CACHE_TTL=900
NEWS_API_MAX_ARTICLES=50

# NewsData.io Configuration (recommended for production)
NEWSDATA_ENABLED=true
NEWSDATA_CACHE_TTL_LATEST=900
NEWSDATA_CACHE_TTL_CRYPTO=600
NEWSDATA_CACHE_TTL_MARKET=600
NEWSDATA_CACHE_TTL_ARCHIVE=3600
NEWSDATA_RATE_LIMIT_REQUESTS=1800
NEWSDATA_RATE_LIMIT_WINDOW_MS=900000
NEWSDATA_CIRCUIT_BREAKER_ENABLED=true
NEWSDATA_CIRCUIT_BREAKER_THRESHOLD=5
NEWSDATA_CIRCUIT_BREAKER_TIMEOUT=60000

# Migration Configuration (for gradual rollout)
NEWS_MIGRATION_ENABLED=false
NEWS_MIGRATION_STRATEGY=newsapi-only
NEWS_MIGRATION_PERCENTAGE=0
NEWS_MIGRATION_FALLBACK_ENABLED=true
NEWS_MIGRATION_PRESERVE_CACHE=true
NEWS_MIGRATION_ROLLBACK_ENABLED=true

# Compatibility Settings
NEWS_COMPATIBILITY_MAP_FORMAT=true
NEWS_COMPATIBILITY_EXTENDED_FIELDS=false
NEWS_COMPATIBILITY_DEFAULT_AUTHOR=Unknown
NEWS_COMPATIBILITY_DEFAULT_SOURCE=Unknown Source

# ============================================================================
# Service Configuration
# ============================================================================
# Port for health check endpoint
HEALTH_CHECK_PORT=3000

# Enable manual analysis triggers via API
ENABLE_MANUAL_TRIGGERS=true

# ============================================================================
# Opik Configuration (Observability) - RECOMMENDED
# ============================================================================
# Sign up at: https://www.comet.com/opik

OPIK_API_KEY=your_production_opik_key_here
OPIK_PROJECT_NAME=tradewizard-monitor-prod
OPIK_WORKSPACE=production
OPIK_TRACK_COSTS=true
OPIK_TAGS=production,v1.0,automated-monitor

# Self-hosted Opik (uncomment if using self-hosted)
# OPIK_BASE_URL=https://your-opik-instance.com

# ============================================================================
# LangGraph Configuration
# ============================================================================
# Use postgres checkpointer for production (requires Supabase)
LANGGRAPH_CHECKPOINTER=postgres
LANGGRAPH_RECURSION_LIMIT=25
LANGGRAPH_STREAM_MODE=values

# ============================================================================
# Agent Configuration
# ============================================================================
# Maximum time per agent execution (milliseconds)
AGENT_TIMEOUT_MS=10000

# Minimum agents required for consensus
MIN_AGENTS_REQUIRED=2

# ============================================================================
# Consensus Configuration
# ============================================================================
# Minimum edge to recommend trade (5%)
MIN_EDGE_THRESHOLD=0.05

# High disagreement threshold (15%)
HIGH_DISAGREEMENT_THRESHOLD=0.15

# ============================================================================
# Logging Configuration
# ============================================================================
# Days to retain audit logs
AUDIT_TRAIL_RETENTION_DAYS=90

# ============================================================================
# External Data Sources (Optional)
# ============================================================================
# Configure if you have API keys for these services

# NewsAPI (legacy - will be deprecated)
# NEWS_API_KEY=your_newsapi_key_here

# NewsData.io (recommended)
# NEWSDATA_API_KEY=your_newsdata_api_key_here

# Twitter API v2
# TWITTER_BEARER_TOKEN=your_twitter_bearer_token_here

# Reddit API
# REDDIT_CLIENT_ID=your_reddit_client_id_here
# REDDIT_CLIENT_SECRET=your_reddit_client_secret_here
# REDDIT_USER_AGENT=TradeWizard/1.0

# ============================================================================
# Advanced Configuration (Optional)
# ============================================================================

# Database connection pool settings
# DB_POOL_MIN=2
# DB_POOL_MAX=10
# DB_POOL_IDLE_TIMEOUT_MS=30000
# DB_POOL_CONNECTION_TIMEOUT_MS=2000

# Retry configuration
# MAX_RETRY_ATTEMPTS=3
# RETRY_BASE_DELAY_MS=1000
# RETRY_MAX_DELAY_MS=10000

# Circuit breaker configuration
# CIRCUIT_BREAKER_THRESHOLD=5
# CIRCUIT_BREAKER_TIMEOUT_MS=60000
# CIRCUIT_BREAKER_RESET_TIMEOUT_MS=30000

# Rate limiting
# RATE_LIMIT_WINDOW_MS=60000
# RATE_LIMIT_MAX_REQUESTS=100

# ============================================================================
# Monitoring and Alerting (Optional)
# ============================================================================

# PagerDuty integration
# PAGERDUTY_INTEGRATION_KEY=your_pagerduty_key_here

# Slack webhook for alerts
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Email alerts
# ALERT_EMAIL=admin@example.com
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASSWORD=your_app_password_here

# ============================================================================
# Security Configuration (Optional)
# ============================================================================

# API authentication for manual triggers
# API_KEY=your_secure_api_key_here

# CORS configuration
# CORS_ORIGIN=https://your-frontend-domain.com

# Rate limiting for API endpoints
# API_RATE_LIMIT_WINDOW_MS=60000
# API_RATE_LIMIT_MAX_REQUESTS=100

# ============================================================================
# Feature Flags (Optional)
# ============================================================================

# Enable/disable specific features
# ENABLE_MARKET_DISCOVERY=true
# ENABLE_SCHEDULED_ANALYSIS=true
# ENABLE_MARKET_UPDATES=true
# ENABLE_QUOTA_MANAGEMENT=true
# ENABLE_COST_TRACKING=true

# ============================================================================
# Agent Autonomous Mode Configuration
# ============================================================================
# Autonomous mode is now ENABLED BY DEFAULT (recommended)
# Agents use LangChain's tool-calling capabilities to autonomously fetch and
# analyze data during execution, providing higher quality analysis.
#
# To disable autonomous mode for a specific agent, set its variable to false:
# BREAKING_NEWS_AGENT_AUTONOMOUS=false
# MEDIA_SENTIMENT_AGENT_AUTONOMOUS=false
# MARKET_MICROSTRUCTURE_AGENT_AUTONOMOUS=false
# POLLING_AGENT_AUTONOMOUS=false

# Breaking News Agent Configuration
BREAKING_NEWS_AGENT_AUTONOMOUS=true          # Autonomous mode enabled by default
BREAKING_NEWS_AGENT_MAX_TOOL_CALLS=5         # Max tools per analysis
BREAKING_NEWS_AGENT_TIMEOUT=45000            # Timeout in milliseconds
BREAKING_NEWS_AGENT_CACHE_ENABLED=true       # Enable result caching
BREAKING_NEWS_AGENT_FALLBACK_TO_BASIC=true   # Fallback on error

# Media Sentiment Agent Configuration
MEDIA_SENTIMENT_AGENT_AUTONOMOUS=true        # Autonomous mode enabled by default
MEDIA_SENTIMENT_AGENT_MAX_TOOL_CALLS=5
MEDIA_SENTIMENT_AGENT_TIMEOUT=45000
MEDIA_SENTIMENT_AGENT_CACHE_ENABLED=true
MEDIA_SENTIMENT_AGENT_FALLBACK_TO_BASIC=true

# Market Microstructure Agent Configuration
MARKET_MICROSTRUCTURE_AGENT_AUTONOMOUS=true  # Autonomous mode enabled by default
MARKET_MICROSTRUCTURE_AGENT_MAX_TOOL_CALLS=5
MARKET_MICROSTRUCTURE_AGENT_TIMEOUT=45000
MARKET_MICROSTRUCTURE_AGENT_CACHE_ENABLED=true
MARKET_MICROSTRUCTURE_AGENT_FALLBACK_TO_BASIC=true

# Polling Agent Configuration
POLLING_AGENT_AUTONOMOUS=true                # Autonomous mode enabled by default
POLLING_AGENT_MAX_TOOL_CALLS=5
POLLING_AGENT_TIMEOUT=45000
POLLING_AGENT_CACHE_ENABLED=true
POLLING_AGENT_FALLBACK_TO_BASIC=true

# ============================================================================
# Notes
# ============================================================================
# 
# Production Checklist:
# - [ ] All REQUIRED variables are set
# - [ ] API keys are production keys (not development)
# - [ ] Supabase project is production project
# - [ ] Opik project is production project
# - [ ] File permissions are restrictive (chmod 600)
# - [ ] File is not committed to version control
# - [ ] Backup of this file is stored securely
# - [ ] API quotas are appropriate for production load
# - [ ] Monitoring and alerts are configured
# - [ ] Log aggregation is set up
# 
# Security Best Practices:
# - Store this file outside version control
# - Use environment-specific API keys
# - Rotate API keys regularly (every 90 days)
# - Use strong, unique passwords
# - Enable 2FA on all service accounts
# - Restrict file permissions (chmod 600)
# - Use secrets management service (AWS Secrets Manager, etc.)
# 
# Cost Management:
# - Start with MAX_MARKETS_PER_CYCLE=1
# - Monitor costs daily for first week
# - Gradually increase if within budget
# - Set up cost alerts in Opik
# - Set up budget alerts in LLM provider dashboards
# 
# For more information, see:
# - docs/PRODUCTION_DEPLOYMENT.md
# - docs/RUNBOOK.md
# - docs/MONITORING_ALERTS.md
